{
  "command": "cisco_ios_show_ip_bgp_vpnv4_all_neighbors",
  "source": "ntc",
  "status": "success",
  "match_ratio": 1.0,
  "textfsm_rows": 1,
  "ttp_rows": 1,
  "ttp_template": "<group name=\"bgp_state_inbound_routemap_localhost_ip_localhost_port\">\nBGP neighbor is {{NEIGHBOR}},  vrf {{VRF}},  remote AS {{REMOTE_AS}},  local AS {{LOCAL_AS | ORPHRASE}}, external link\n  BGP version 4, remote router ID {{REMOTE_ROUTER_ID | ORPHRASE}}\n  BGP state = {{BGP_STATE | ORPHRASE}}, up for 2w6d\n  Route map for incoming advertisements is {{INBOUND_ROUTEMAP | ORPHRASE}}\n  Route map for outgoing advertisements is {{OUTBOUND_ROUTEMAP | ORPHRASE}}\nLocal host: {{LOCALHOST_IP | re(\"\\\\d+\\\\.\\\\d+\\\\.\\\\d+\\\\.\\\\d+\")}}, Local port: {{LOCALHOST_PORT | ORPHRASE}}\nForeign host: 10.255.11.4, Foreign port: {{REMOTE_PORT | ORPHRASE}}\n</group>",
  "error": null,
  "textfsm_parsed": [
    {
      "NEIGHBOR": "10.255.11.4",
      "VRF": "VRF11",
      "REMOTE_AS": "65514",
      "LOCAL_AS": "65534",
      "REMOTE_ROUTER_ID": "10.255.255.6",
      "BGP_STATE": "Established",
      "LOCALHOST_IP": "10.255.11.204",
      "LOCALHOST_PORT": "33514",
      "REMOTE_IP": "10.255.11.4",
      "REMOTE_PORT": "179",
      "INBOUND_ROUTEMAP": "BGP_IN",
      "OUTBOUND_ROUTEMAP": "BGP_OUT"
    }
  ],
  "ttp_parsed": [
    {
      "bgp_state_inbound_routemap_localhost_ip_localhost_port": {
        "REMOTE_PORT": "179",
        "LOCALHOST_IP": "10.255.11.204",
        "LOCALHOST_PORT": "33514",
        "OUTBOUND_ROUTEMAP": "BGP_OUT",
        "INBOUND_ROUTEMAP": "BGP_IN",
        "BGP_STATE": "Established",
        "REMOTE_ROUTER_ID": "10.255.255.6",
        "NEIGHBOR": "10.255.11.4",
        "VRF": "VRF11",
        "REMOTE_AS": "65514",
        "LOCAL_AS": "65534"
      }
    }
  ],
  "cli_content": "BGP neighbor is 10.255.11.4,  vrf VRF11,  remote AS 65514,  local AS 65534, external link\n  BGP version 4, remote router ID 10.255.255.6\n  BGP state = Established, up for 2w6d\n  Last read 00:00:54, last write 00:00:35, hold time is 180, keepalive interval is 60 seconds\n  Neighbor sessions:\n    1 active, is not multisession capable (disabled)\n  Neighbor capabilities:\n    Route refresh: advertised and received(new)\n    Four-octets ASN Capability: advertised and received\n    Address family IPv4 Unicast: advertised and received\n    Enhanced Refresh Capability: advertised and received\n    Multisession Capability: \n    Stateful switchover support enabled: NO for session 1\n  Message statistics:\n    InQ depth is 0\n    OutQ depth is 0\n    \n                         Sent       Rcvd\n    Opens:                  1          1\n    Notifications:          0          0\n    Updates:                1          2\n    Keepalives:         32792      32803\n    Route Refresh:          0          0\n    Total:              32794      32808\n  Do log neighbor state changes (via global configuration)\n  Default minimum time between advertisement runs is 0 seconds\n\n For address family: VPNv4 Unicast\n  Translates address family IPv4 Unicast for VRF VRF11\n  Session: 10.255.11.4\n  BGP table version 2399, neighbor version 2399/0\n  Output queue size : 0\n  Index 4, Advertise bit 0\n  4 update-group member\n  Inbound soft reconfiguration allowed\n  Community attribute sent to this neighbor\n  Extended-community attribute sent to this neighbor\n  Inbound path policy configured\n  Outbound path policy configured\n  Route map for incoming advertisements is BGP_IN\n  Route map for outgoing advertisements is BGP_OUT\n  Slow-peer detection is disabled\n  Slow-peer split-update-group dynamic is disabled\n                                 Sent       Rcvd\n  Prefix activity:               ----       ----\n    Prefixes Current:               0          1 (Consumes 272 bytes)\n    Prefixes Total:                 0          1\n    Implicit Withdraw:              0          0\n    Explicit Withdraw:              0          0\n    Used as bestpath:             n/a          0\n    Used as multipath:            n/a          0\n    Used as secondary:            n/a          0\n    Saved (soft-reconfig):        n/a          1 (Consumes 136 bytes)\n\n                                   Outbound    Inbound\n  Local Policy Denied Prefixes:    --------    -------\n    Other Policies:                       1        n/a\n    Total:                                1          0\n  Number of NLRIs in the update sent: max 0, min 0\n  Last detected as dynamic slow peer: never\n  Dynamic slow peer recovered: never\n  Refresh Epoch: 2\n  Last Sent Refresh Start-of-rib: never\n  Last Sent Refresh End-of-rib: never\n  Last Received Refresh Start-of-rib: 2w6d\n  Last Received Refresh End-of-rib: 2w6d\n  Refresh-In took 0 seconds\n                                       Sent       Rcvd\n        Refresh activity:              ----       ----\n          Refresh Start-of-RIB          0          1\n          Refresh End-of-RIB            0          1\n\n  Address tracking is enabled, the RIB does have a route to 10.255.11.4\n  Route to peer address reachability Up: 1; Down: 0\n    Last notification 2w6d\n  Connections established 1; dropped 0\n  Last reset never\n  External BGP neighbor configured for connected checks (single-hop no-disable-connected-check)\n  Interface associated: Tunnel11 (peering address in same link)\n  Transport(tcp) path-mtu-discovery is enabled\n  Graceful-Restart is disabled\n  SSO is disabled\nConnection state is ESTAB, I/O status: 1, unread input bytes: 0            \nConnection is ECN Disabled, Mininum incoming TTL 0, Outgoing TTL 1\nLocal host: 10.255.11.204, Local port: 33514\nForeign host: 10.255.11.4, Foreign port: 179\nConnection tableid (VRF): 3\nMaximum output segment queue size: 50\n\nEnqueued packets for retransmit: 0, input: 0  mis-ordered: 0 (0 bytes)\n\nEvent Timers (current time is 0x4AE0695D1):\nTimer          Starts    Wakeups            Next\nRetrans         32804         10             0x0\nTimeWait            0          0             0x0\nAckHold         32805      32223             0x0\nSendWnd             0          0             0x0\nKeepAlive           0          0             0x0\nGiveUp              0          0             0x0\nPmtuAger      1781782    1781781     0x4AE069986\nDeadWait            0          0             0x0\nLinger              0          0             0x0\nProcessQ            0          0             0x0\n\niss: 2115004957  snduna: 2115628086  sndnxt: 2115628086\nirs: 3296319032  rcvnxt: 3296942468\n\nsndwnd:  15700  scale:      0  maxrcvwnd:  16384\nrcvwnd:  15396  scale:      0  delrcvwnd:    988\n\nSRTT: 1000 ms, RTTO: 1003 ms, RTV: 3 ms, KRTT: 0 ms\nminRTT: 22 ms, maxRTT: 1000 ms, ACK hold: 200 ms\nuptime: 1788576610 ms, Sent idletime: 35652 ms, Receive idletime: 35428 ms \nStatus Flags: active open\nOption Flags: VRF id set, nagle, path mtu capable\nIP Precedence value : 6\n\nDatagrams (max data segment is 1360 bytes):\nRcvd: 65496 (out of order: 0), with data: 32806, total data bytes: 623435\nSent: 65477 (retransmit: 10, fastretransmit: 0, partialack: 0, Second Congestion: 0), with data: 32794, total data bytes: 623128\n\n Packets received in fast path: 0, fast processed: 0, slow path: 0\n fast lock acquisition failures: 0, slow path: 0\nTCP Semaphore      0x7F1747D2ACD0  FREE ",
  "textfsm_template": "Value NEIGHBOR (\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\nValue VRF (\\S+)\nValue REMOTE_AS (\\d+)\nValue LOCAL_AS (\\d+)\nValue PEER_GROUP (\\S+)\nValue REMOTE_ROUTER_ID (\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\nValue BGP_STATE (\\w+)\nValue LOCALHOST_IP (\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\nValue LOCALHOST_PORT (\\d+)\nValue REMOTE_IP (\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\nValue REMOTE_PORT (\\d+)\nValue INBOUND_ROUTEMAP (\\S+)\nValue OUTBOUND_ROUTEMAP (\\S+)\n\nStart\n  # Capture first line, which shows the BGP neighor and remote AS number\n  ^BGP\\s+neighbor\\s+is -> Continue.Record\n  ^BGP\\s+neighbor\\s+is\\s+${NEIGHBOR},\\s+vrf\\s+${VRF},\\s+remote\\s+AS\\s+${REMOTE_AS},\\s+local\\s+AS\\s+${LOCAL_AS}\n  # Capture BGP peer group\n  # Example: 'Member of peer-group RR_SERVERS for session parameters'\n  ^\\s*Member\\s+of\\s+peer-group\\s+${PEER_GROUP}\n  #\n  # Capture remote router ID\n  # Example: ' BGP version 4, remote router ID 10.10.255.14'\n  ^.+remote\\s+router\\s+ID\\s+${REMOTE_ROUTER_ID}\n  #\n  # Capture BGP state\n  # Example: ' BGP state = Established, up for 7w3d'\n  ^\\s+BGP\\s+state\\s+=\\s+${BGP_STATE}\n  #\n  # Capture Inbound/Outbound Route Maps\n  # Example: 'Route map for incoming advertisements is BGP_Vendor_in'\n  # Example: 'Route map for outgoing advertisements is BGP_Vendor_out'\n  ^\\s+Route\\s+map\\s+for\\s+incoming\\s+advertisements\\s+is\\s+${INBOUND_ROUTEMAP}\n  ^\\s+Route\\s+map\\s+for\\s+outgoing\\s+advertisements\\s+is\\s+${OUTBOUND_ROUTEMAP}\n  #\n  # Match local host and port\n  # Example: 'Local host: 10.10.255.13, Local port: 39443'\n  ^Local\\s+host:\\s+${LOCALHOST_IP},\\s+Local\\s+port:\\s+${LOCALHOST_PORT}\n  #\n  # Match foreign host and port\n  # Example: 'Foreign host: 10.10.255.14, Local port: 39443'\n  ^Foreign\\s+host:\\s+${REMOTE_IP},\\s+Foreign\\s+port:\\s+${REMOTE_PORT}\n  #^.+ -> Error"
}