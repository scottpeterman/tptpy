{
  "command": "hp_comware_display_ip_vpn-instance_instance-name",
  "source": "ntc",
  "status": "success",
  "match_ratio": 1.0,
  "textfsm_rows": 1,
  "ttp_rows": 1,
  "ttp_template": "<group name=\"id_interfaces_ipv4_export_rts_ipv4_import_rts\">\n  VPN-Instance Name and Index : {{NAME}}, {{ID | ORPHRASE}}\n  Route Distinguisher : {{RD | ORPHRASE}}\n  {{IPV4_EXPORT_RTS | ORPHRASE}}\n</group>",
  "error": null,
  "textfsm_parsed": [
    {
      "NAME": "vpnb",
      "ID": "2",
      "RD": "100:2",
      "IPV4_EXPORT_RTS": "222:2",
      "IPV4_IMPORT_RTS": "222:2, 111:1",
      "INTERFACES": "Vlan-interface20, FortyGigE1/0/53, GigabitEthernet1/0/25"
    }
  ],
  "ttp_parsed": [
    {
      "id_interfaces_ipv4_export_rts_ipv4_import_rts": {
        "IPV4_EXPORT_RTS": "Interfaces : Vlan-interface20, FortyGigE1/0/53,",
        "RD": "100:2",
        "NAME": "vpnb",
        "ID": "2"
      }
    }
  ],
  "cli_content": "  VPN-Instance Name and Index : vpnb, 2\n  Route Distinguisher : 100:2\n  Interfaces : Vlan-interface20, FortyGigE1/0/53,\n               GigabitEthernet1/0/25\n  Address-family IPv4:\n   Export VPN Targets :\n       222:2\n   Import VPN Targets :\n       222:2 111:1\n",
  "textfsm_template": "Value Required NAME ([^,]+)\nValue Required ID (\\d+)\nValue RD (\\d+:\\d+)\nValue List IPV4_EXPORT_RTS (\\d+:\\d+)\nValue List IPV4_IMPORT_RTS (\\d+:\\d+)\nValue List IPV6_EXPORT_RTS (\\d+:\\d+)\nValue List IPV6_IMPORT_RTS (\\d+:\\d+)\nValue DESCRIPTION (.*)\nValue IPV4_EXPORT_POLICY (\\S+)\nValue IPV4_IMPORT_POLICY (\\S+)\nValue IPV4_TUNNEL_POLICY (\\S+)\nValue IPV6_EXPORT_POLICY (\\S+)\nValue IPV6_IMPORT_POLICY (\\S+)\nValue IPV6_TUNNEL_POLICY (\\S+)\nValue List INTERFACES ([^,]+)\n\n\nStart\n  ^\\s*VPN-Instance\\s+Name\\s+and\\s+(Index|ID)\\s*:\\s+${NAME}, ${ID}\n  ^\\s*Route\\s+Distinguisher\\s*:\\s+${RD}\n  ^\\s*Description\\s*:\\s*${DESCRIPTION}\n  # IPv4 targets (block)\n  ^\\s*Address-family|s+IPv4 -> AFIPv4\n  # Export IPv4 targets (inline)\n  ^\\s*Export\\s+VPN\\s+Targets\\s*:\\s+${IPV4_EXPORT_RTS} -> Continue\n  ^\\s*Export\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){1}\\s+${IPV4_EXPORT_RTS},* -> Continue\n  ^\\s*Export\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){2}\\s+${IPV4_EXPORT_RTS},* -> Continue\n  ^\\s*Export\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){3}\\s+${IPV4_EXPORT_RTS},* -> Continue\n  ^\\s*Export\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){4}\\s+${IPV4_EXPORT_RTS},* -> Continue\n  ^\\s*Export\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){5}\\s+${IPV4_EXPORT_RTS},* -> Continue\n  ^\\s*Export\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){6}\\s+${IPV4_EXPORT_RTS},* -> Continue\n  ^\\s*Export\\s+VPN\\s+Targets\\s*:\n  # Import IPv4 targets\n  ^\\s*Import\\s+VPN\\s+Targets\\s*:\\s+${IPV4_IMPORT_RTS} -> Continue\n  ^\\s*Import\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){1}\\s+${IPV4_IMPORT_RTS},* -> Continue\n  ^\\s*Import\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){2}\\s+${IPV4_IMPORT_RTS},* -> Continue\n  ^\\s*Import\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){3}\\s+${IPV4_IMPORT_RTS},* -> Continue\n  ^\\s*Import\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){4}\\s+${IPV4_IMPORT_RTS},* -> Continue\n  ^\\s*Import\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){5}\\s+${IPV4_IMPORT_RTS},* -> Continue\n  ^\\s*Import\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){6}\\s+${IPV4_IMPORT_RTS},* -> Continue\n  ^\\s*Import\\s+VPN\\s+Targets\\s*:\n  # IPv4 policies\n  ^\\s*Import\\s+Route\\s+Policy\\s*:\\s+${IPV4_IMPORT_POLICY}\n  ^\\s*Export\\s+Route\\s+Policy\\s*:\\s+${IPV4_EXPORT_POLICY}\n  ^\\s*Tunnel\\s+Policy\\s*:\\s+${IPV4_TUNNEL_POLICY}\n  # Export IPv6 targets\n  ^\\s*IPv6\\s+Export\\s+VPN\\s+Targets\\s*:\\s+${IPV6_EXPORT_RTS} -> Continue\n  ^\\s*IPv6\\s+Export\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){1}\\s+${IPV6_EXPORT_RTS},* -> Continue\n  ^\\s*IPv6\\s+Export\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){2}\\s+${IPV6_EXPORT_RTS},* -> Continue\n  ^\\s*IPv6\\s+Export\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){3}\\s+${IPV6_EXPORT_RTS},* -> Continue\n  ^\\s*IPv6\\s+Export\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){4}\\s+${IPV6_EXPORT_RTS},* -> Continue\n  ^\\s*IPv6\\s+Export\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){5}\\s+${IPV6_EXPORT_RTS},* -> Continue\n  ^\\s*IPv6\\s+Export\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){6}\\s+${IPV6_EXPORT_RTS},* -> Continue\n  ^\\s*IPv6\\s+Export\\s+VPN\\s+Targets\\s*:\n  # Import IPv6 targets\n  ^\\s*IPv6\\s+Import\\s+VPN\\s+Targets\\s*:\\s+${IPV6_IMPORT_RTS} -> Continue\n  ^\\s*IPv6\\s+Import\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){1}\\s+${IPV6_IMPORT_RTS},* -> Continue\n  ^\\s*IPv6\\s+Import\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){2}\\s+${IPV6_IMPORT_RTS},* -> Continue\n  ^\\s*IPv6\\s+Import\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){3}\\s+${IPV6_IMPORT_RTS},* -> Continue\n  ^\\s*IPv6\\s+Import\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){4}\\s+${IPV6_IMPORT_RTS},* -> Continue\n  ^\\s*IPv6\\s+Import\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){5}\\s+${IPV6_IMPORT_RTS},* -> Continue\n  ^\\s*IPv6\\s+Import\\s+VPN\\s+Targets\\s*:(?:\\s+\\d+:\\d+){6}\\s+${IPV6_IMPORT_RTS},* -> Continue\n  ^\\s*IPv6\\s+Import\\s+VPN\\s+Targets\\s*:\n  # IPv6 policies\n  ^\\s*IPv6\\s+Import\\s+Route\\s+Policy\\s*:\\s+${IPV6_IMPORT_POLICY}\n  ^\\s*IPv6\\s+Export\\s+Route\\s+Policy\\s*:\\s+${IPV6_EXPORT_POLICY}\n  ^\\s*IPv6\\s+Tunnel\\s+Policy\\s*:\\s+${IPV6_TUNNEL_POLICY}\n  # Interfaces\n  ^\\s*Interfaces\\s*:\\s+${INTERFACES},* -> Continue\n  ^\\s*Interfaces\\s*:(?:\\s+[^,]+,){1}\\s+${INTERFACES},* -> Continue\n  ^\\s*Interfaces\\s*:(?:\\s+[^,]+,){2}\\s+${INTERFACES},* -> Continue\n  ^\\s*Interfaces\\s*:(?:\\s+[^,]+,){3}\\s+${INTERFACES},* -> Continue\n  ^\\s*Interfaces\\s*:(?:\\s+[^,]+,){4}\\s+${INTERFACES},* -> Continue\n  ^\\s{12,}${INTERFACES},* -> Continue\n  ^\\s{12,}(?:\\s+[^,]+,){1}\\s+${INTERFACES},* -> Continue\n  ^\\s{12,}(?:\\s+[^,]+,){2}\\s+${INTERFACES},* -> Continue\n  ^\\s{12,}(?:\\s+[^,]+,){3}\\s+${INTERFACES},* -> Continue\n  ^\\s{12,}(?:\\s+[^,]+,){4}\\s+${INTERFACES},* -> Continue\n  # End of Interfaces\n  ^\\s*Interfaces\\s*:\n  ^\\s{12,}\n  # Drop\n  ^\\s*Create\\s+time\n  ^\\s*Up\\s+time\n  ^\\s*.*Maximum\\s+Routes\\s+Limit\n  ^\\s{4,}\n  ^. -> Error\n\nAFIPv4\n  ^\\s*Export\\s+VPN\\s+Targets -> ExportIPv4Targets\n\nExportIPv4Targets\n  ^\\s{4,}${IPV4_EXPORT_RTS} -> Continue\n  ^\\s{4,}(?:\\s+\\d+:\\d+){1}\\s+${IPV4_EXPORT_RTS} -> Continue\n  ^\\s{4,}(?:\\s+\\d+:\\d+){2}\\s+${IPV4_EXPORT_RTS} -> Continue\n  ^\\s{4,}(?:\\s+\\d+:\\d+){3}\\s+${IPV4_EXPORT_RTS} -> Continue\n  ^\\s{4,}(?:\\s+\\d+:\\d+){4}\\s+${IPV4_EXPORT_RTS} -> Continue\n  ^\\s{4,}(?:\\s+\\d+:\\d+){5}\\s+${IPV4_EXPORT_RTS} -> Continue\n  ^\\s{4,}(?:\\s+\\d+:\\d+){6}\\s+${IPV4_EXPORT_RTS} -> Continue\n  ^\\s{4,}\\d+:\\d+\n  ^\\s*Import\\s+VPN\\s+Targets -> ImportIPv4Targets\n  ^. -> Error\n\nImportIPv4Targets\n  ^\\s{4,}${IPV4_IMPORT_RTS} -> Continue\n  ^\\s{4,}(?:\\s+\\d+:\\d+){1}\\s+${IPV4_IMPORT_RTS} -> Continue\n  ^\\s{4,}(?:\\s+\\d+:\\d+){2}\\s+${IPV4_IMPORT_RTS} -> Continue\n  ^\\s{4,}(?:\\s+\\d+:\\d+){3}\\s+${IPV4_IMPORT_RTS} -> Continue\n  ^\\s{4,}(?:\\s+\\d+:\\d+){4}\\s+${IPV4_IMPORT_RTS} -> Continue\n  ^\\s{4,}(?:\\s+\\d+:\\d+){5}\\s+${IPV4_IMPORT_RTS} -> Continue\n  ^\\s{4,}(?:\\s+\\d+:\\d+){6}\\s+${IPV4_IMPORT_RTS} -> Continue\n  ^\\s{4,}\\d+:\\d+\n  ^. -> Error\n"
}