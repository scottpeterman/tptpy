{
  "command": "cisco_ios_show_ip_bgp_neighbors",
  "source": "ntc",
  "status": "success",
  "match_ratio": 1.0,
  "textfsm_rows": 1,
  "ttp_rows": 1,
  "ttp_template": "<group name=\"bgp_state_localhost_ip_localhost_port_neighbor\">\nBGP neighbor is {{NEIGHBOR}},  remote AS {{REMOTE_AS | ORPHRASE}}, internal link\n Member of peer-group {{PEER_GROUP | ORPHRASE}} for session parameters\n  BGP version 4, remote router ID {{REMOTE_ROUTER_ID | ORPHRASE}}\n  BGP state = {{BGP_STATE | ORPHRASE}}, up for 7w3d\nLocal host: {{LOCALHOST_IP | re(\"\\\\d+\\\\.\\\\d+\\\\.\\\\d+\\\\.\\\\d+\")}}, Local port: {{LOCALHOST_PORT | ORPHRASE}}\nForeign host: 20.30.255.14, Foreign port: {{REMOTE_PORT | ORPHRASE}}\n</group>",
  "error": null,
  "textfsm_parsed": [
    {
      "NEIGHBOR": "20.30.255.14",
      "REMOTE_AS": "1255",
      "PEER_GROUP": "RR_SERVERS",
      "REMOTE_ROUTER_ID": "20.40.1.1",
      "BGP_STATE": "Established",
      "LOCALHOST_IP": "20.30.255.13",
      "LOCALHOST_PORT": "39443",
      "REMOTE_IP": "20.30.255.14",
      "REMOTE_PORT": "179"
    }
  ],
  "ttp_parsed": [
    {
      "bgp_state_localhost_ip_localhost_port_neighbor": {
        "REMOTE_PORT": "179",
        "LOCALHOST_IP": "20.30.255.13",
        "LOCALHOST_PORT": "39443",
        "BGP_STATE": "Established",
        "REMOTE_ROUTER_ID": "20.40.1.1",
        "PEER_GROUP": "RR_SERVERS",
        "NEIGHBOR": "20.30.255.14",
        "REMOTE_AS": "1255"
      }
    }
  ],
  "cli_content": "BGP neighbor is 20.30.255.14,  remote AS 1255, internal link\n Member of peer-group RR_SERVERS for session parameters\n  BGP version 4, remote router ID 20.40.1.1\n  BGP state = Established, up for 7w3d\n  Last read 00:00:24, last write 00:00:22, hold time is 180, keepalive interval is 60 seconds\n  Neighbor sessions:\n    1 active, is not multisession capable (disabled)\n  Neighbor capabilities:\n    Route refresh: advertised and received(new)\n    Four-octets ASN Capability: advertised and received\n    Address family IPv4 Unicast: advertised and received\n    Multisession Capability:\n  Message statistics:\n    InQ depth is 0\n    OutQ depth is 0\n\n                         Sent       Rcvd\n    Opens:                  1          1\n    Notifications:          0          0\n    Updates:                1         94\n    Keepalives:         83823      84638\n    Route Refresh:          0          0\n    Total:              83825      84733\n  Default minimum time between advertisement runs is 0 seconds\n\n For address family: IPv4 Unicast\n  Session: 20.30.255.14\n  BGP table version 270, neighbor version 270/0\n  Output queue size : 0\n  Index 1, Advertise bit 0\n  1 update-group member\n  RR_SERVERS peer-group member\n  Inbound soft reconfiguration allowed\n  Slow-peer detection is disabled\n  Slow-peer split-update-group dynamic is disabled\n                                 Sent       Rcvd\n  Prefix activity:               ----       ----\n    Prefixes Current:               0        113 (Consumes 6328 bytes)\n    Prefixes Total:                 0        217\n    Implicit Withdraw:              0         52\n    Explicit Withdraw:              0         52\n    Used as bestpath:             n/a        113\n    Used as multipath:            n/a          0\n\n                                   Outbound    Inbound\n  Local Policy Denied Prefixes:    --------    -------\n    Bestpath from this peer:            217        n/a\n    Invalid Path:                        52        n/a\n    Total:                              269          0\n  Number of NLRIs in the update sent: max 0, min 0\n  Last detected as dynamic slow peer: never\n  Dynamic slow peer recovered: never\n\n  Address tracking is enabled, the RIB does have a route to 20.30.255.14\n  Connections established 1; dropped 0\n  Last reset never\n  Transport(tcp) path-mtu-discovery is enabled\n  Graceful-Restart is disabled\nConnection state is ESTAB, I/O status: 1, unread input bytes: 0\nConnection is ECN Disabled, Mininum incoming TTL 0, Outgoing TTL 255\nLocal host: 20.30.255.13, Local port: 39443\nForeign host: 20.30.255.14, Foreign port: 179\nConnection tableid (VRF): 0\nMaximum output segment queue size: 50\n\nEnqueued packets for retransmit: 0, input: 0  mis-ordered: 0 (0 bytes)\n\nEvent Timers (current time is 0x1106B0BD8):\nTimer          Starts    Wakeups            Next\nRetrans         83827          1             0x0\nTimeWait            0          0             0x0\nAckHold         84719      83274             0x0\nSendWnd             0          0             0x0\nKeepAlive           0          0             0x0\nGiveUp              0          0             0x0\nPmtuAger            1          1             0x0\nDeadWait            0          0             0x0\nLinger              0          0             0x0\nProcessQ            0          0             0x0\n\niss: 3730243128  snduna: 3731835842  sndnxt: 3731835842\nirs: 2485586108  rcvnxt: 2487200336\n\nsndwnd:  33561  scale:      0  maxrcvwnd:  16384\nrcvwnd:  16099  scale:      0  delrcvwnd:    285\n\nSRTT: 1000 ms, RTTO: 1003 ms, RTV: 3 ms, KRTT: 0 ms\nminRTT: 0 ms, maxRTT: 1000 ms, ACK hold: 200 ms\nStatus Flags: active open\nOption Flags: nagle, path mtu capable, SACK option permitted\nIP Precedence value : 6\n\nDatagrams (max data segment is 1460 bytes):\nRcvd: 168543 (out of order: 0), with data: 84718, total data bytes:41614227\nSent: 168204 (retransmit: 1, fastretransmit: 0, partialack: 0, Second Congestion: 0), with data: 83825, total data bytes: 1592713\n Packets received in fast path: 0, fast processed: 0, slow path: 0\n fast lock acquisition failures: 0, slow path: 0\n",
  "textfsm_template": "Value NEIGHBOR (\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\nValue VRF (\\S+)\nValue REMOTE_AS (\\d+)\nValue PEER_GROUP (\\S+)\nValue REMOTE_ROUTER_ID (\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\nValue BGP_STATE (\\w+)\nValue LOCALHOST_IP (\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\nValue LOCALHOST_PORT (\\d+)\nValue REMOTE_IP (\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\nValue REMOTE_PORT (\\d+)\nValue INBOUND_ROUTEMAP (\\S+)\nValue OUTBOUND_ROUTEMAP (\\S+)\n\nStart\n  # Capture first line, which shows the BGP neighor and remote AS number\n  ^BGP\\s+neighbor\\s+is -> Continue.Record\n  ^BGP\\s+neighbor\\s+is\\s+${NEIGHBOR},(\\s+vrf\\s+${VRF},)?\\s+remote\\s+AS\\s+${REMOTE_AS}\n  # Capture BGP peer group\n  # Example: 'Member of peer-group RR_SERVERS for session parameters'\n  ^\\s*Member\\s+of\\s+peer-group\\s+${PEER_GROUP}\n  # \n  # Capture remote router ID\n  # Example: ' BGP state = Established, up for 7w3d'\n  ^.+remote\\s+router\\s+ID\\s+${REMOTE_ROUTER_ID}\n  #\n  # Capture BGP state\n  # Example: ' BGP state = Established, up for 7w3d'\n  ^\\s+BGP\\s+state\\s+=\\s+${BGP_STATE}\n  #\n  # Capture Inbound/Outbound Route Maps\n  # Example: 'Route map for incoming advertisements is BGP_Vendor_in'\n  # Example: 'Route map for outgoing advertisements is BGP_Vendor_out'\n  ^\\s+Route\\s+map\\s+for\\s+incoming\\s+advertisements\\s+is\\s+${INBOUND_ROUTEMAP}\n  ^\\s+Route\\s+map\\s+for\\s+outgoing\\s+advertisements\\s+is\\s+${OUTBOUND_ROUTEMAP}\n  #\n  # Match local host and port\n  # Example: 'Local host: 10.10.255.13, Local port: 39443'\n  ^Local\\s+host:\\s+${LOCALHOST_IP},\\s+Local\\s+port:\\s+${LOCALHOST_PORT}\n  # \n  # Match local host and port\n  # Example: 'Local host: 10.10.255.13, Local port: 39443'\n  ^Foreign\\s+host:\\s+${REMOTE_IP},\\s+Foreign\\s+port:\\s+${REMOTE_PORT}\n  #^.+ -> Error\n"
}