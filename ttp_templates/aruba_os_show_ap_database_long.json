{
  "command": "aruba_os_show_ap_database_long",
  "source": "ntc",
  "status": "success",
  "match_ratio": 1.0,
  "textfsm_rows": 3,
  "ttp_rows": 3,
  "ttp_template": "<group name=\"ap_name_group_ap_model_ip_address_status_flags_primary_standby_mac_address_serial_port_fqln_outer_ip_user\">\n{{AP_NAME}} {{GROUP}} {{AP_MODEL}} {{IP_ADDRESS | re(\"\\\\d+\\\\.\\\\d+\\\\.\\\\d+\\\\.\\\\d+\")}} {{STATUS | ORPHRASE}} {{FLAGS}} {{PRIMARY}} {{STANDBY}} {{MAC_ADDRESS | re(\"[0-9a-fA-F:.-]+\")}} {{SERIAL | re(\"\\\\w+\")}} {{PORT | ORPHRASE}} {{FQLN}} {{OUTER_IP}} {{USER}}\n</group>",
  "error": null,
  "textfsm_parsed": [
    {
      "AP_NAME": "ap-building-1",
      "GROUP": "building",
      "AP_MODEL": "635",
      "IP_ADDRESS": "192.168.1.1",
      "STATUS": "Up 2d:17h:8m:4s",
      "FLAGS": "2Sf",
      "PRIMARY": "192.168.2.2",
      "STANDBY": "192.168.2.3",
      "MAC_ADDRESS": "cc:88:c7:11:22:33",
      "SERIAL": "CNM12345",
      "PORT": "N/A",
      "FQLN": "N/A",
      "OUTER_IP": "N/A",
      "USER": "N/A"
    },
    {
      "AP_NAME": "ap-building-2",
      "GROUP": "building",
      "AP_MODEL": "515",
      "IP_ADDRESS": "192.168.1.2",
      "STATUS": "Up 2d:17h:8m:23s",
      "FLAGS": "2Sf",
      "PRIMARY": "192.168.2.2",
      "STANDBY": "192.168.2.3",
      "MAC_ADDRESS": "cc:88:c7:11:22:34",
      "SERIAL": "CNM12346",
      "PORT": "N/A",
      "FQLN": "N/A",
      "OUTER_IP": "N/A",
      "USER": "N/A"
    },
    {
      "AP_NAME": "ap-building-3",
      "GROUP": "building",
      "AP_MODEL": "505H",
      "IP_ADDRESS": "192.168.1.3",
      "STATUS": "Up 2d:16h:57m:55s",
      "FLAGS": "2Sf",
      "PRIMARY": "192.168.2.2",
      "STANDBY": "192.168.2.3",
      "MAC_ADDRESS": "cc:88:c7:11:22:35",
      "SERIAL": "CNM12347",
      "PORT": "N/A",
      "FQLN": "N/A",
      "OUTER_IP": "N/A",
      "USER": "N/A"
    }
  ],
  "ttp_parsed": [
    {
      "ap_name_group_ap_model_ip_address_status_flags_primary_standby_mac_address_serial_port_fqln_outer_ip_user": [
        {
          "AP_NAME": "ap-building-1",
          "GROUP": "building",
          "AP_MODEL": "635",
          "IP_ADDRESS": "192.168.1.1",
          "STATUS": "Up 2d:17h:8m:4s",
          "FLAGS": "2Sf",
          "PRIMARY": "192.168.2.2",
          "STANDBY": "192.168.2.3",
          "MAC_ADDRESS": "cc:88:c7:11:22:33",
          "SERIAL": "CNM12345",
          "PORT": "N/A",
          "FQLN": "N/A",
          "OUTER_IP": "N/A",
          "USER": "N/A"
        },
        {
          "AP_NAME": "ap-building-2",
          "GROUP": "building",
          "AP_MODEL": "515",
          "IP_ADDRESS": "192.168.1.2",
          "STATUS": "Up 2d:17h:8m:23s",
          "FLAGS": "2Sf",
          "PRIMARY": "192.168.2.2",
          "STANDBY": "192.168.2.3",
          "MAC_ADDRESS": "cc:88:c7:11:22:34",
          "SERIAL": "CNM12346",
          "PORT": "N/A",
          "FQLN": "N/A",
          "OUTER_IP": "N/A",
          "USER": "N/A"
        },
        {
          "AP_NAME": "ap-building-3",
          "GROUP": "building",
          "AP_MODEL": "505H",
          "IP_ADDRESS": "192.168.1.3",
          "STATUS": "Up 2d:16h:57m:55s",
          "FLAGS": "2Sf",
          "PRIMARY": "192.168.2.2",
          "STANDBY": "192.168.2.3",
          "MAC_ADDRESS": "cc:88:c7:11:22:35",
          "SERIAL": "CNM12347",
          "PORT": "N/A",
          "FQLN": "N/A",
          "OUTER_IP": "N/A",
          "USER": "N/A"
        }
      ]
    }
  ],
  "cli_content": "\nAP Database\n-----------\nName                Group       AP Type  IP Address     Status             Flags  Switch IP       Standby IP       Wired MAC Address  Serial #    Port  FQLN  Outer IP  User\n----                -----       -------  ----------     ------             -----  ---------       ----------       -----------------  --------    ----  ----  --------  ----\nap-building-1    building      635      192.168.1.1    Up 2d:17h:8m:4s    2Sf    192.168.2.2  192.168.2.3    cc:88:c7:11:22:33  CNM12345  N/A   N/A   N/A   N/A\nap-building-2     building      515      192.168.1.2  Up 2d:17h:8m:23s   2Sf    192.168.2.2  192.168.2.3    cc:88:c7:11:22:34  CNM12346  N/A   N/A   N/A   N/A\nap-building-3    building      505H      192.168.1.3  Up 2d:16h:57m:55s  2Sf    192.168.2.2  192.168.2.3    cc:88:c7:11:22:35  CNM12347  N/A   N/A   N/A   N/A\n\n\nFlags: 1 = 802.1x authenticated AP use EAP-PEAP;   1+ = 802.1x use EST;    1- = 802.1x use factory cert\n       2 = Using IKE version 2;                    4 = WiFi Uplink\n       B = Built-in AP;                            C = Cellular RAP;       D = Dirty or no config\n       E = Regulatory Domain Mismatch;             F = AP failed 802.1x authentication\n       G = No such group;        I = Inactive;     J = USB cert at AP;     L = Unlicensed\n       M = Mesh node\n       N = Duplicate name;       P = PPPoe AP;     R = Remote AP;          R- = Remote AP requires Auth\n       S = Standby-mode AP;      T = Thermal ShutDown;    U = Unprovisioned;    X = Maintenance Mode\n       Y = Mesh Recovery\n       b = bypass of AP1x timeout;    c = CERT-based RAP;    e = Custom EST cert;    f = No Spectrum FFT support\n       i = Indoor;                    o = Outdoor;           l = LAG 802.3ad;        m = Protocol Mismatch\n       p = In deep-sleep status;      r = Power Restricted;  s = LACP striping;      t = Temperature Restricted\n       u = Custom-Cert RAP;           z = Datazone AP\n",
  "textfsm_template": "Value AP_NAME (\\S+)\nValue GROUP (\\S+)\nValue AP_MODEL (\\S+)\nValue IP_ADDRESS ((([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5]))\nValue STATUS (.+?)\nValue FLAGS (\\S+)\nValue PRIMARY ((([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5]))\nValue STANDBY ((([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5]))\nValue MAC_ADDRESS ([a-fA-F0-9]{2}(:[a-fA-F0-9]{2}){5})\nValue SERIAL (\\S+)\nValue PORT (.+?)\nValue FQLN (.+?)\nValue OUTER_IP (.+?)\nValue USER (.+?)\n\nStart\n  ^${AP_NAME}\\s+${GROUP}\\s+${AP_MODEL}\\s+${IP_ADDRESS}\\s+${STATUS}\\s+${FLAGS}\\s+${PRIMARY}\\s+${STANDBY}\\s+${MAC_ADDRESS}\\s+${SERIAL}\\s+${PORT}\\s+${FQLN}\\s+${OUTER_IP}\\s+${USER}\\s*$$ -> Record\n  ^AP Database\n  ^.+\\.+\n  ^Name\\s+Group\\s+AP Type\\s+IP Address\\s+Status\\s+Flags\\s+Switch IP\\s+Standby IP\\s+Wired MAC Address\\s+Serial #\\s+Port\\s+FQLN\\s+Outer IP\\s+User\\s*$$\n  ^Flags:\n  ^\\s*$$\n  ^\\s+\n  ^Total\n  ^-+\n  ^. -> Error\n"
}