{
  "command": "aruba_os_show_ap_database",
  "source": "ntc",
  "status": "success",
  "match_ratio": 1.0,
  "textfsm_rows": 3,
  "ttp_rows": 3,
  "ttp_template": "<group name=\"ap_name_group_ap_model_ip_address_status_flags_primary_standby\">\n{{AP_NAME}} {{GROUP}} {{AP_MODEL}} {{IP_ADDRESS | re(\"\\\\d+\\\\.\\\\d+\\\\.\\\\d+\\\\.\\\\d+\")}} {{STATUS | ORPHRASE}} {{FLAGS}} {{PRIMARY}} {{STANDBY | ORPHRASE}}\n</group>",
  "error": null,
  "textfsm_parsed": [
    {
      "AP_NAME": "ap-building-1",
      "GROUP": "building",
      "AP_MODEL": "635",
      "IP_ADDRESS": "192.168.1.1",
      "STATUS": "Up 2d:17h:8m:4s",
      "FLAGS": "2Sf",
      "PRIMARY": "192.168.2.2",
      "STANDBY": "192.168.2.3"
    },
    {
      "AP_NAME": "ap-building-2",
      "GROUP": "building",
      "AP_MODEL": "515",
      "IP_ADDRESS": "192.168.1.2",
      "STATUS": "Up 2d:17h:8m:23s",
      "FLAGS": "2Sf",
      "PRIMARY": "192.168.2.2",
      "STANDBY": "192.168.2.3"
    },
    {
      "AP_NAME": "ap-building-3",
      "GROUP": "building",
      "AP_MODEL": "505H",
      "IP_ADDRESS": "192.168.1.3",
      "STATUS": "Up 2d:16h:57m:55s",
      "FLAGS": "2Sf",
      "PRIMARY": "192.168.2.2",
      "STANDBY": "192.168.2.3"
    }
  ],
  "ttp_parsed": [
    {
      "ap_name_group_ap_model_ip_address_status_flags_primary_standby": [
        {
          "AP_NAME": "ap-building-1",
          "GROUP": "building",
          "AP_MODEL": "635",
          "IP_ADDRESS": "192.168.1.1",
          "STATUS": "Up 2d:17h:8m:4s",
          "FLAGS": "2Sf",
          "PRIMARY": "192.168.2.2",
          "STANDBY": "192.168.2.3"
        },
        {
          "AP_NAME": "ap-building-2",
          "GROUP": "building",
          "AP_MODEL": "515",
          "IP_ADDRESS": "192.168.1.2",
          "STATUS": "Up 2d:17h:8m:23s",
          "FLAGS": "2Sf",
          "PRIMARY": "192.168.2.2",
          "STANDBY": "192.168.2.3"
        },
        {
          "AP_NAME": "ap-building-3",
          "GROUP": "building",
          "AP_MODEL": "505H",
          "IP_ADDRESS": "192.168.1.3",
          "STATUS": "Up 2d:16h:57m:55s",
          "FLAGS": "2Sf",
          "PRIMARY": "192.168.2.2",
          "STANDBY": "192.168.2.3"
        }
      ]
    }
  ],
  "cli_content": "\nAP Database\n-----------\nName                Group       AP Type  IP Address     Status             Flags  Switch IP       Standby IP\n----                -----       -------  ----------     ------             -----  ---------       ----------\nap-building-1    building      635      192.168.1.1    Up 2d:17h:8m:4s    2Sf    192.168.2.2  192.168.2.3\nap-building-2     building      515      192.168.1.2  Up 2d:17h:8m:23s   2Sf    192.168.2.2  192.168.2.3\nap-building-3    building      505H      192.168.1.3  Up 2d:16h:57m:55s  2Sf    192.168.2.2  192.168.2.3\n\n\nFlags: 1 = 802.1x authenticated AP use EAP-PEAP;   1+ = 802.1x use EST;    1- = 802.1x use factory cert\n       2 = Using IKE version 2;                    4 = WiFi Uplink\n       B = Built-in AP;                            C = Cellular RAP;       D = Dirty or no config\n       E = Regulatory Domain Mismatch;             F = AP failed 802.1x authentication\n       G = No such group;        I = Inactive;     J = USB cert at AP;     L = Unlicensed\n       M = Mesh node\n       N = Duplicate name;       P = PPPoe AP;     R = Remote AP;          R- = Remote AP requires Auth\n       S = Standby-mode AP;      T = Thermal ShutDown;    U = Unprovisioned;    X = Maintenance Mode\n       Y = Mesh Recovery\n       b = bypass of AP1x timeout;    c = CERT-based RAP;    e = Custom EST cert;    f = No Spectrum FFT support\n       i = Indoor;                    o = Outdoor;           l = LAG 802.3ad;        m = Protocol Mismatch\n       p = In deep-sleep status;      r = Power Restricted;  s = LACP striping;      t = Temperature Restricted\n       u = Custom-Cert RAP;           z = Datazone AP\n",
  "textfsm_template": "Value AP_NAME (\\S+)\nValue GROUP (\\S+)\nValue AP_MODEL (\\S+)\nValue IP_ADDRESS ((([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5]))\nValue STATUS (.+?)\nValue FLAGS (\\S+)\nValue PRIMARY ((([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5]))\nValue STANDBY ((([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5]))\n\nStart\n  ^${AP_NAME}\\s+${GROUP}\\s+${AP_MODEL}\\s+${IP_ADDRESS}\\s+${STATUS}\\s+${FLAGS}\\s+${PRIMARY}\\s+${STANDBY}\\s*$$ -> Record\n  ^AP Database\n  ^.+\\.+\n  ^Name\\s+Group\\s+AP\\s+Type\\s+IP\\s+Address\\s+Status\\s+Flags\\s+Switch\\s+IP\\s+Standby IP\\s*$$\n  ^Flags:\n  ^\\s*$$\n  ^\\s+\n  ^Total\n  ^-+\n  ^. -> Error\n"
}