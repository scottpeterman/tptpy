{
  "command": "mikrotik_routeros_log_print_detail_without-paging",
  "source": "ntc",
  "status": "success",
  "match_ratio": 1.1428571428571428,
  "textfsm_rows": 7,
  "ttp_rows": 8,
  "ttp_template": "<group name=\"datetime_whole_message\">\n time={{DATETIME | ORPHRASE}} {{WHOLE_MESSAGE | ORPHRASE}}\n</group>",
  "error": null,
  "textfsm_parsed": [
    {
      "MONTH": "jul",
      "DAY": "19",
      "HOUR": "16",
      "MINUTE": "27",
      "SECOND": "01",
      "TOPIC": "script,info",
      "MESSAGE": "Ping testA: Packets Sent = 18, Packets Loss = 10 %",
      "DATETIME": "jul/19 16:27:01",
      "WHOLE_MESSAGE": "topics=script,info message=\"Ping testA: Packets Sent = 18, Packets Loss = 10 % \""
    },
    {
      "MONTH": "jul",
      "DAY": "19",
      "HOUR": "16",
      "MINUTE": "37",
      "SECOND": "01",
      "TOPIC": "script,info",
      "MESSAGE": "Ping testA: Packets Sent = 12, Packets Loss = 40 %",
      "DATETIME": "jul/19 16:37:01",
      "WHOLE_MESSAGE": "topics=script,info message=\"Ping testA: Packets Sent = 12, Packets Loss = 40 % \""
    },
    {
      "MONTH": "jul",
      "DAY": "19",
      "HOUR": "19",
      "MINUTE": "17",
      "SECOND": "01",
      "TOPIC": "script,info",
      "MESSAGE": "Ping testA: Packets Sent = 17, Packets Loss = 15 %",
      "DATETIME": "jul/19 19:17:01",
      "WHOLE_MESSAGE": "topics=script,info message=\"Ping testA: Packets Sent = 17, Packets Loss = 15 % \""
    },
    {
      "MONTH": "jul",
      "DAY": "19",
      "HOUR": "03",
      "MINUTE": "05",
      "SECOND": "02",
      "TOPIC": "script,warning",
      "MESSAGE": "Connection via Box bad. Reset USB Modem",
      "DATETIME": "jul/19 03:05:02",
      "WHOLE_MESSAGE": "topics=script,warning message=\"Connection via Box bad. Reset USB Modem\""
    },
    {
      "MONTH": "jul",
      "DAY": "20",
      "HOUR": "03",
      "MINUTE": "07",
      "SECOND": "40",
      "TOPIC": "interface,info",
      "MESSAGE": "lte1 link down",
      "DATETIME": "jul/20 03:07:40",
      "WHOLE_MESSAGE": "topics=interface,info message=\"lte1 link down\""
    },
    {
      "MONTH": "jul",
      "DAY": "20",
      "HOUR": "03",
      "MINUTE": "07",
      "SECOND": "46",
      "TOPIC": "interface,info",
      "MESSAGE": "lte1 link up",
      "DATETIME": "jul/20 03:07:46",
      "WHOLE_MESSAGE": "topics=interface,info message=\"lte1 link up\""
    },
    {
      "MONTH": "jul",
      "DAY": "20",
      "HOUR": "03",
      "MINUTE": "07",
      "SECOND": "46",
      "TOPIC": "dhcp,info",
      "MESSAGE": "dhcp-client on lte1 got IP address 192.168.1.2",
      "DATETIME": "jul/20 03:07:46",
      "WHOLE_MESSAGE": "topics=dhcp,info message=\"dhcp-client on lte1 got IP address 192.168.1.2\""
    }
  ],
  "ttp_parsed": [
    {
      "datetime_whole_message": [
        {
          "DATETIME": "jul/19",
          "WHOLE_MESSAGE": "14:27:01 topics=script,info message=\"Ping testA: Packets Sent = 18, Packets Loss = 10 % \""
        },
        {
          "DATETIME": "jul/19",
          "WHOLE_MESSAGE": "16:27:01 topics=script,info message=\"Ping testA: Packets Sent = 18, Packets Loss = 10 % \""
        },
        {
          "DATETIME": "jul/19",
          "WHOLE_MESSAGE": "16:37:01 topics=script,info message=\"Ping testA: Packets Sent = 12, Packets Loss = 40 % \""
        },
        {
          "DATETIME": "jul/19",
          "WHOLE_MESSAGE": "19:17:01 topics=script,info message=\"Ping testA: Packets Sent = 17, Packets Loss = 15 % \""
        },
        {
          "DATETIME": "jul/19",
          "WHOLE_MESSAGE": "03:05:02 topics=script,warning message=\"Connection via Box bad. Reset USB Modem\""
        },
        {
          "DATETIME": "jul/20",
          "WHOLE_MESSAGE": "03:07:40 topics=interface,info message=\"lte1 link down\""
        },
        {
          "DATETIME": "jul/20",
          "WHOLE_MESSAGE": "03:07:46 topics=interface,info message=\"lte1 link up\""
        },
        {
          "DATETIME": "jul/20",
          "WHOLE_MESSAGE": "03:07:46 topics=dhcp,info message=\"dhcp-client on lte1 got IP address 192.168.1.2\""
        }
      ]
    }
  ],
  "cli_content": " time=jul/19 14:27:01 topics=script,info message=\"Ping testA: Packets Sent = 18, Packets Loss = 10 % \"\n\n time=jul/19 16:27:01 topics=script,info message=\"Ping testA: Packets Sent = 18, Packets Loss = 10 % \"\n\n time=jul/19 16:37:01 topics=script,info message=\"Ping testA: Packets Sent = 12, Packets Loss = 40 % \"\n\n time=jul/19 19:17:01 topics=script,info message=\"Ping testA: Packets Sent = 17, Packets Loss = 15 % \"\n\n time=jul/19 03:05:02 topics=script,warning message=\"Connection via Box bad. Reset USB Modem\"\n\n time=jul/20 03:07:40 topics=interface,info message=\"lte1 link down\"\n\n time=jul/20 03:07:46 topics=interface,info message=\"lte1 link up\"\n\n time=jul/20 03:07:46 topics=dhcp,info message=\"dhcp-client on lte1 got IP address 192.168.1.2\"\n",
  "textfsm_template": "Value MONTH (\\w{3})\nValue DAY (\\d{2})\nValue YEAR (\\d{4})\nValue HOUR (\\d{2})\nValue MINUTE (\\d{2})\nValue SECOND (\\d{2})\nValue TOPIC (\\S+)\nValue MESSAGE (.+)\n# Aggregating values\nValue DATETIME ((\\w{3}/\\d{2}(/\\d{4})?\\s+)?\\d{2}:\\d{2}:\\d{2})\nValue WHOLE_MESSAGE (.+?)\n\nStart\n  # Check the general structure to skip all the data that are not log messages\n  ^\\s*time=${DATETIME}\\s+${WHOLE_MESSAGE}\\s*$$ -> LogMessages\n\nLogMessages\n  # Here we do more general parsing to get the log messages' time and text as a whole\n  ^\\s*time=${DATETIME}\\s+${WHOLE_MESSAGE}\\s*$$ -> Continue\n  # and then extract specific values\n  ^\\s*time=(${MONTH}/${DAY}(/${YEAR})?\\s+)?${HOUR}:${MINUTE}:${SECOND}\\s+topics=${TOPIC}\\s+message=\\\"${MESSAGE}\\\"\\s*$$ -> Record\n  ^\\s*$$\n  ^. -> Error\n"
}